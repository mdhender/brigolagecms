<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="generator" content="Pod::Site 0.50" />
    <title>Bric::Biz::Asset::Business::Story</title>
  </head>
  <body class="pod">

<ul id="index">
  <li><a href="Story.html#Name">Name</a></li>
  <li><a href="Story.html#Synopsis">Synopsis</a></li>
  <li><a href="Story.html#Description">Description</a></li>
  <li><a href="Story.html#Interface">Interface</a>
    <ul>
      <li><a href="Story.html#Constructors">Constructors</a></li>
      <li><a href="Story.html#Destructors">Destructors</a></li>
      <li><a href="Story.html#Public-Class-Methods">Public Class Methods</a></li>
      <li><a href="Story.html#Public-Instance-Methods">Public Instance Methods</a></li>
    </ul>
  </li>
  <li><a href="Story.html#Private">Private</a>
    <ul>
      <li><a href="Story.html#Private-Class-Methods">Private Class Methods</a></li>
      <li><a href="Story.html#Private-Instance-Methods">Private Instance Methods</a></li>
    </ul>
  </li>
  <li><a href="Story.html#Notes">Notes</a></li>
  <li><a href="Story.html#Author">Author</a></li>
  <li><a href="Story.html#See-Also">See Also</a></li>
</ul>

<h1 id="Name">Name</h1>

<p>Bric::Biz::Asset::Business::Story - The interface to the Story Object</p>

<h1 id="Synopsis">Synopsis</h1>

<pre><code># creation of new objects
$story = Bric::Biz::Asset::Business::Story-&gt;new( $init )
$story = Bric::Biz::Asset::Business::Story-&gt;lookup( $param )
($stories || @stories) = Bric::Biz::Asset::Business::Story-&gt;list($param)

# list of object ids
($ids || @ids) = Bric::Biz::Asset::Business::Story-&gt;list_ids($param)

# Type of workflow.
my $wf_type = Bric::Biz::Asset::Business::Story-&gt;workflow_type;

 # General information
$asset       = $asset-&gt;get_id()
$asset       = $asset-&gt;set_description($description)
$description = $asset-&gt;get_description()

# User information
$usr_id      = $asset-&gt;get_user__id()
$asset       = $asset-&gt;set_user__id($usr_id)

# Version information
$vers_grp_id = $asset-&gt;get_version_grp__id();
$vers_id     = $asset-&gt;get_asset_version_id();

# Desk information
$desk        = $asset-&gt;get_current_desk;
$asset       = $asset-&gt;set_current_desk($desk);

# Workflow methods.
$id  = $asset-&gt;get_workflow_id;
$obj = $asset-&gt;get_workflow_object;
$id  = $asset-&gt;set_workflow_id;

# Access note information
$asset         = $asset-&gt;set_note($note);
my $note       = $asset-&gt;get_note;
my $notes_href = $asset-&gt;get_notes()

# Access active status
$asset            = $asset-&gt;deactivate()
$asset            = $asset-&gt;activate()
($asset || undef) = $asset-&gt;is_active()

# Publish info
$needs_publish = $asset-&gt;needs_publish();

## METHODS INHERITED FROM Bric::Biz::Asset::Business ##

# General info
$name = $biz-&gt;get_name()
$biz  = $biz-&gt;set_name($name)
$ver  = $biz-&gt;get_version()

# Element Type information
$elem_type   = $biz-&gt;get_element_type;
$name        = $biz-&gt;get_element_name()
$at_id       = $biz-&gt;get_element_type_id()
$biz         = $biz-&gt;set_element_type_id($at_id)

# Element methods
$element  = $biz-&gt;get_element_type()
@elements = $biz-&gt;get_elements()
$biz      = $biz-&gt;add_field($field_type_obj, $data)
$value    = $biz-&gt;get_value($name, $obj_order)
$parts    = $biz-&gt;get_possible_field_types()

# Container methods
$new_container = $biz-&gt;add_container($at_contaier_obj)
$container     = $biz-&gt;get_container($name, $obj_order)
@containes     = $biz-&gt;get_possible_containers()

# Access Categories
$cat             = $biz-&gt;get_primary_category;
$biz             = $biz-&gt;set_primary_category($cat);
($cats || @cats) = $biz-&gt;get_secondary_categories($sortby);
$biz             = $biz-&gt;add_categories([$category, ...])
($cats || @cats) = $biz-&gt;get_categories()
$biz             = $biz-&gt;delete_categories([$category, ...]);

# Access keywords
$biz               = $biz-&gt;add_keywords(\@kws)
($kw_list || @kws) = $biz-&gt;get_keywords()
($self || undef)   = $biz-&gt;has_keyword($keyword)
$biz               = $biz-&gt;del_keywords([$kw, ...])

# Change control
$biz            = $biz-&gt;cancel()
$biz            = $biz-&gt;revert($version)
(undef || $biz) = $biz-&gt;checkin()
$biz            = $biz-&gt;checkout($param)


## INSTANCE METHODS FOR Bric::Biz::Asset::Business::Story

# Manipulation of slug field
$slug  = $story-&gt;get_slug()
$story = $story-&gt;set_slug($slug)

# Access the source ID
$src_id = $story-&gt;get_source__id()

# Change control
($story || undef) = $story-&gt;is_current()

# Ad string management
$story         = $story-&gt;delete_ad_param($key)
$ad_param_hash = $story-&gt;get_ad_param()
$story         = $story-&gt;set_ad_param($key ,$val);

# Publish data
$date  = $story-&gt;get_expire_date()
$story = $story-&gt;set_expire_date()

$date  = $story-&gt;get_publish_date()
$story = $story-&gt;set_publish_date()

# Save to the database
$story = $story-&gt;save()</code></pre>

<h1 id="Description">Description</h1>

<p>Story contains all of the data that will result in published page(s) It contains the metadata and associations with story documents. It inherits from <a rel="section" href="../../../../../../2.0/api/Bric/Biz/Asset/Business.html" name="Bric::Biz::Asset::Business">Bric::Biz::Asset::Business</a></p>

<h1 id="Interface">Interface</h1>

<h2 id="Constructors">Constructors</h2>

<dl>

<dt>$story = Bric::Biz::Asset::Business::Story-&gt;new( $initial_state )</dt>
<dd>

<p>This will create a new story object with an optionally defined initial state</p>

<p>Supported Keys:</p>

<ul>

<li><p>user__id - Required.</p>

</li>
<li><p>active</p>

</li>
<li><p>priority</p>

</li>
<li><p>title - same as name</p>

</li>
<li><p>name - Will be overridden by title</p>

</li>
<li><p>description</p>

</li>
<li><p>workflow_id</p>

</li>
<li><p>slug</p>

</li>
<li><p>element_type_id - Required unless asset type object passed</p>

</li>
<li><p>element_type - the object required unless id is passed</p>

</li>
<li><p>site_id - required</p>

</li>
<li><p>source__id - required</p>

</li>
<li><p>cover_date - will set expire date in conjunction with the source</p>

</li>
</ul>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$story = Bric::Biz::Asset::Business::Story-&gt;lookup( { id =&gt; $id })</dt>
<dd>

<p>This will return a story asset that matches the id provided</p>

<p><b>Throws:</b></p>

<p>&quot;Missing required parameter &#39;id&#39;&quot;</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>Inherited from Asset</p>

</dd>
<dt>(@stories||$stories) = Bric::Biz::Asset::Business::Story-&gt;list($params)</dt>
<dd>

<p>Returns a list or anonymous array of Bric::Biz::Asset::Business::Story objects based on the search parameters passed via an anonymous hash. The supported lookup keys are:</p>

<dl>

<dt>title</dt>
<dd>

<p>The title of the story. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>name</dt>
<dd>

<p>Same as <code>title</code>.</p>

</dd>
<dt>description</dt>
<dd>

<p>Story description. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>id</dt>
<dd>

<p>The story ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>uuid</dt>
<dd>

<p>The story UUID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>exclude_id</dt>
<dd>

<p>A story ID to exclude from the list. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>version</dt>
<dd>

<p>The story version number. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>version_id</dt>
<dd>

<p>The ID of a version of a story. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>slug</dt>
<dd>

<p>The story slug. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>user_id</dt>
<dd>

<p>Returns the versions that are checked out by the user, otherwise returns the most recent version. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>checked_out</dt>
<dd>

<p>A boolean value indicating whether to return only checked out or not checked out stories.</p>

</dd>
<dt>checked_in</dt>
<dd>

<p>If passed a true value, this parameter causes the checked in version of the most current version of the story to be returned. When a story is checked out, there are two instances of the current version: the one checked in last, and the one currently being edited. When the <code>checked_in</code> parameter is a true value, then the instance last checked in is returned, rather than the instance currently checked out. This is useful for users who do not currently have a story checked out and wish to see the story as of the last check in, rather than as currently being worked on in the current checkout. If a story is not currently checked out, this parameter has no effect.</p>

</dd>
<dt>published_version</dt>
<dd>

<p>Returns the versions of the stories as they were last published. The <code>checked_out</code> parameter will be ignored if this parameter is passed a true value.</p>

</dd>
<dt>return_versions</dt>
<dd>

<p>Boolean indicating whether to return pass version objects for each story listed.</p>

</dd>
<dt>active</dt>
<dd>

<p>Boolean indicating whether to return active or inactive stories.</p>

</dd>
<dt>inactive</dt>
<dd>

<p>Returns only inactive stories.</p>

</dd>
<dt>alias_id</dt>
<dd>

<p>Returns a list of stories aliased to the story ID passed as its value. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>category_id</dt>
<dd>

<p>Returns a list of stories in the category represented by a category ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>category_uri</dt>
<dd>

<p>Returns a list of stories with a given category URI. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>keyword</dt>
<dd>

<p>Returns stories associated with a given keyword string (not object). May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>note</dt>
<dd>

<p>Returns stories with a note matching the value associated with any of their versions. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>workflow_id</dt>
<dd>

<p>Return a list of stories in the workflow represented by the workflow ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>desk_id</dt>
<dd>

<p>Returns a list of stories on a desk with the given ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>primary_uri</dt>
<dd>

<p>Returns a list of stories with a given primary URI. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>uri</dt>
<dd>

<p>Returns a list of stories with a given URI. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>story.category</dt>
<dd>

<p>Pass in a story ID, and a list of stories in the same categories as the story with that ID will be returned, minus the story with that ID. This parameter triggers a complex join, which can slow the query time significantly on underpowered servers or systems with a large number of stories. Still, it can be very useful in templates that want to create a list of stories in all of the categories the current story is in. But be sure to use the &lt;Limit&gt; parameter!</p>

</dd>
<dt>site_id</dt>
<dd>

<p>Returns a list of stories associated with a given site ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>site</dt>
<dd>

<p>Returns a list of stories associated with a given site name. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>element_type_id</dt>
<dd>

<p>Returns a list of stories associated with a given element type ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>source_id</dt>
<dd>

<p>Returns a list of stories associated with a given source ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>output_channel_id</dt>
<dd>

<p>Returns a list of stories associated with a given output channel ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>primary_oc_id</dt>
<dd>

<p>Returns a list of stories associated with a given primary output channel ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>priority</dt>
<dd>

<p>Returns a list of stories associated with a given priority value. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>contrib_id</dt>
<dd>

<p>Returns a list of stories associated with a given contributor ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>grp_id</dt>
<dd>

<p>Returns a list of stories that are members of the group with the specified group ID. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>publish_status</dt>
<dd>

<p>Boolean value indicating whether to return published or unpublished stories.</p>

</dd>
<dt>first_publish_date_start</dt>
<dd>

<p>Returns a list of stories first published on or after a given date/time.</p>

</dd>
<dt>first_publish_date_end</dt>
<dd>

<p>Returns a list of stories first published on or before a given date/time.</p>

</dd>
<dt>publish_date_start</dt>
<dd>

<p>Returns a list of stories last published on or after a given date/time.</p>

</dd>
<dt>publish_date_end</dt>
<dd>

<p>Returns a list of stories last published on or before a given date/time.</p>

</dd>
<dt>cover_date_start</dt>
<dd>

<p>Returns a list of stories with a cover date on or after a given date/time.</p>

</dd>
<dt>cover_date_end</dt>
<dd>

<p>Returns a list of stories with a cover date on or before a given date/time.</p>

</dd>
<dt>expire_date_start</dt>
<dd>

<p>Returns a list of stories with a expire date on or after a given date/time.</p>

</dd>
<dt>expire_date_end</dt>
<dd>

<p>Returns a list of stories with a expire date on or before a given date/time.</p>

</dd>
<dt>unexpired</dt>
<dd>

<p>A boolean parameter. Returns a list of stories without an expire date, or with an expire date set in the future.</p>

</dd>
<dt>element_key_name</dt>
<dd>

<p>The key name for the story type element. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>subelement_key_name</dt>
<dd>

<p>The key name for a container element that&#39;s a subelement of a story. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>subelement_id</dt>
<dd>

<p>The ID for a container element that&#39;s a subelement of a story. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>related_story_id</dt>
<dd>

<p>Returns a list of stories that have this story ID as a related story. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>related_media_id</dt>
<dd>

<p>Returns a list of stories that have this media ID as a related media document. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>data_text</dt>
<dd>

<p>Text stored in the fields of the story element or any of its subelements. Only fields that use the &quot;short&quot; storage type will be searched unless the <code>BLOB_SEARCH</code> <i>bricolage.conf</i> directive is enabled, in which case the &quot;blob&quot; storage will also be searched. May use <code>ANY</code> for a list of possible values.</p>

</dd>
<dt>Order</dt>
<dd>

<p>A property name or array reference of property names to order by.</p>

</dd>
<dt>OrderDirection</dt>
<dd>

<p>The direction in which to order the records, either &quot;ASC&quot; for ascending (the default) or &quot;DESC&quot; for descending. This value is applied to the property specified by the <code>Order</code> parameter, and may also be an array reference. If no value is supplied for any <code>Order</code> property name, it will default to ascending.</p>

</dd>
<dt>Limit</dt>
<dd>

<p>A maximum number of objects to return. If not specified, all objects that match the query will be returned.</p>

</dd>
<dt>Offset</dt>
<dd>

<p>The number of objects to skip before listing the remaining objcts or the number of objects specified by <code>Limit</code>.</p>

</dd>
<dt>simple</dt>
<dd>

<p>Triggers a single OR search that hits title, description, primary_uri and keywords.</p>

</dd>
</dl>

<p><b>Throws:</b></p>

<ul>

<li><p>Unable to connect to database.</p>

</li>
<li><p>Unable to prepare SQL statement.</p>

</li>
<li><p>Unable to select column into arrayref.</p>

</li>
<li><p>Unable to execute SQL statement.</p>

</li>
<li><p>Unable to bind to columns to statement handle.</p>

</li>
<li><p>Unable to fetch row from statement handle.</p>

</li>
</ul>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>Inherited from Bric::Biz::Asset;</p>

</dd>
</dl>

<h2 id="Destructors">Destructors</h2>

<dl>

<dt>$self-&gt;DESTROY</dt>
<dd>

<p>This is a dummy method to save autoload the time to find it</p>

</dd>
</dl>

<h2 id="Public-Class-Methods">Public Class Methods</h2>

<dl>

<dt>($ids || @ids) = Bric::Biz::Asset::Business::Story-&gt;list_ids( $criteria )</dt>
<dd>

<p>Returns an unordered list or array reference of story object IDs that match the criteria defined. The criteria are the same as those for the <code>list()</code> method except for <code>Order</code> and <code>OrderDirection</code>, which <code>list_ids()</code> ignore.</p>

<p>See the <code>list()</code> method for the list of supported Keys.</p>

<p><b>Throws:</b> NONE.</p>

<p><b>Side Effects:</b> NONE.</p>

<p><b>Notes:</b> Inherited from Bric::Biz::Asset.</p>

</dd>
<dt>my $key_name = Bric::Biz::Asset::Business::Story-&gt;key_name()</dt>
<dd>

<p>Returns the key name of this class.</p>

<p><b>Throws:</b> NONE.</p>

<p><b>Side Effects:</b> NONE.</p>

<p><b>Notes:</b> NONE.</p>

</dd>
<dt>$meths = Bric::Biz::Asset::Business::Story-&gt;my_meths</dt>
<dd>

</dd>
<dt>(@meths || $meths_aref) = Bric::Biz::Asset::Business::Story-&gt;my_meths(TRUE)</dt>
<dd>

<p>Returns an anonymous hash of introspection data for this object. If called with a true argument, it will return an ordered list or anonymous array of introspection data. The format for each introspection item introspection is as follows:</p>

<p>Each hash key is the name of a property or attribute of the object. The value for a hash key is another anonymous hash containing the following keys:</p>

<dl>

<dt>name</dt>
<dd>

<p>The name of the property or attribute. Is the same as the hash key when an anonymous hash is returned.</p>

</dd>
<dt>disp</dt>
<dd>

<p>The display name of the property or attribute.</p>

</dd>
<dt>get_meth</dt>
<dd>

<p>A reference to the method that will retrieve the value of the property or attribute.</p>

</dd>
<dt>get_args</dt>
<dd>

<p>An anonymous array of arguments to pass to a call to get_meth in order to retrieve the value of the property or attribute.</p>

</dd>
<dt>set_meth</dt>
<dd>

<p>A reference to the method that will set the value of the property or attribute.</p>

</dd>
<dt>set_args</dt>
<dd>

<p>An anonymous array of arguments to pass to a call to set_meth in order to set the value of the property or attribute.</p>

</dd>
<dt>type</dt>
<dd>

<p>The type of value the property or attribute contains. There are only three types:</p>

<dl>

<dt>short</dt>
<dd>

</dd>
<dt>date</dt>
<dd>

</dd>
<dt>blob</dt>
<dd>

</dd>
</dl>

</dd>
<dt>len</dt>
<dd>

<p>If the value is a &#39;short&#39; value, this hash key contains the length of the field.</p>

</dd>
<dt>search</dt>
<dd>

<p>The property is searchable via the list() and list_ids() methods.</p>

</dd>
<dt>req</dt>
<dd>

<p>The property or attribute is required.</p>

</dd>
<dt>props</dt>
<dd>

<p>An anonymous hash of properties used to display the property or attribute. Possible keys include:</p>

<dl>

<dt>type</dt>
<dd>

<p>The display field type. Possible values are</p>

<dl>

<dt>text</dt>
<dd>

</dd>
<dt>textarea</dt>
<dd>

</dd>
<dt>password</dt>
<dd>

</dd>
<dt>hidden</dt>
<dd>

</dd>
<dt>radio</dt>
<dd>

</dd>
<dt>checkbox</dt>
<dd>

</dd>
<dt>select</dt>
<dd>

</dd>
</dl>

</dd>
<dt>length</dt>
<dd>

<p>The Length, in letters, to display a text or password field.</p>

</dd>
<dt>maxlength</dt>
<dd>

<p>The maximum length of the property or value - usually defined by the SQL DDL.</p>

</dd>
</dl>

</dd>
<dt>rows</dt>
<dd>

<p>The number of rows to format in a textarea field.</p>

</dd>
<dt>cols</dt>
<dd>

<p>The number of columns to format in a textarea field.</p>

</dd>
<dt>vals</dt>
<dd>

<p>An anonymous hash of key/value pairs representing the values and display names to use in a select list.</p>

</dd>
</dl>

<p><b>Throws:</b> NONE.</p>

<p><b>Side Effects:</b> NONE.</p>

<p><b>Notes:</b> NONE.</p>

</dd>
<dt>my $wf_type = Bric::Biz::Asset::Business::Story-&gt;workflow_type</dt>
<dd>

<p>Returns the value of the Bric::Biz::Workflow <code>STORY_WORKFLOW</code> constant.</p>

</dd>
</dl>

<h2 id="Public-Instance-Methods">Public Instance Methods</h2>

<dl>

<dt>$uri = $biz-&gt;get_uri(($cat_id||$cat_obj), ($oc_id||$oc_obj))</dt>
<dd>

<p>Returns the a URL for this business asset. The URL is determined by the pre- and post- directory strings of an output channel, the URI of the business object&#39;s asset type, and the cover date if the asset type is not a fixed URL.</p>

<p><b>Throws:</b></p>

<ul>

<li><p>No category associated with story.</p>

</li>
<li><p>Category not associated with story.</p>

</li>
<li><p>Output channel not associated with story.</p>

</li>
</ul>

<p><b>Side Effects:</b> NONE.</p>

<p><b>Notes:</b> NONE.</p>

</dd>
<dt>$story = $story-&gt;set_slug($slug);</dt>
<dd>

<p>Sets the slug for this story</p>

<p><b>Throws:</b></p>

<p>Slug Must conform to URL character rules.</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$slug = $story-&gt;get_slug()</dt>
<dd>

<p>returns the slug that has been set upon this story</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>($categories || @categories) = $ba-&gt;get_categories()</dt>
<dd>

<p>This will return a list of categories that have been associated with the business asset.</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$cat = $story-&gt;get_primary_category()</dt>
<dd>

<p>Returns the category object that has been defined as primary</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$story = $story-&gt;set_primary_category($cat_id || $cat)</dt>
<dd>

<p>Defines a category as being the the primary one for this story. If a category is already marked as being primary, this will disassociate it.</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>(@cats || $cats) = $story-&gt;get_secondary_categories( $sortby )</dt>
<dd>

<p>Returns the non-primary categories that are associated with this story. Takes an optional sort by field.</p>

<p>Supported Keys:</p>

<ul>

<li><p>uri - Sort in alphabetically ascending uri order.</p>

</li>
</ul>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$ba = $ba-&gt;add_categories(@categories)</dt>
<dd>

<p>This will take a list category objects or Is and will associate them with the story.</p>

<p><b>Side Effects:</b></p>

<p>Adds the <code>asset_grp_ids</code> of the categories to grp_ids (unless they are already there).</p>

</dd>
<dt>$ba = $ba-&gt;delete_categories(@categories);</dt>
<dd>

<p>This will take a list of categories and remove them from the story.</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$story = $story-&gt;checkout()</dt>
<dd>

<p>Preforms story specific checkout stuff and then calls checkout on the parent class</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>my (@gids || $gids_aref) = $story-&gt;get_grp_ids</dt>
<dd>

</dd>
<dt>my (@gids || $gids_aref) = Bric::Biz::Asset::Business::Story-&gt;get_grp_ids</dt>
<dd>

<p>Returns a list or anonymous array of Bric::Biz::Group object ids representing the groups of which this Bric::Biz::Asset::Business::Story object is a member.</p>

<p><b>Throws:</b> See Bric::Util::Grp::list().</p>

<p><b>Side Effects:</b> NONE.</p>

<p><b>Notes:</b> This list includes the Group IDs of the Desk, Workflow, and categories in which the story is a member. [Actually, this method is currently disabled, since categories don&#39;t actually add assets to an underlying group. If we later find that customers need to control access to assets based on category, we&#39;ll figure out a way to rectify this.]</p>

</dd>
<dt>$story = $story-&gt;revert();</dt>
<dd>

<p>Reverts the current version to a prior version</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$story = $story-&gt;clone()</dt>
<dd>

<p>Creates an identical copy of this asset with a different id</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$story = $story-&gt;save()</dt>
<dd>

<p>Updates the story object in the database</p>

<p><b>Throws:</b> NONE</p>

<p><b>Side Effects:</b> NONE</p>

<p><b>Notes:</b> NONE</p>

</dd>
</dl>

<h1 id="Private">Private</h1>

<h2 id="Private-Class-Methods">Private Class Methods</h2>

<h2 id="Private-Instance-Methods">Private Instance Methods</h2>

<dl>

<dt>$contribs = $self-&gt;_get_contributors()</dt>
<dd>

<p>Returns the contributors from a cache or looks em up</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_insert_contributor( $id, $role)</dt>
<dd>

<p>Inserts a row into the mapping table for contributors</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_update_contributor($id, $role)</dt>
<dd>

<p>Updates the contributor mapping table</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_delete_contributor($id)</dt>
<dd>

<p>Deletes the rows from these mapping tables</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$category_data = $self-&gt;_get_categories()</dt>
<dd>

<p>Returns the category data structure for this story</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$ba = $ba-&gt;_sync_categories</dt>
<dd>

<p>Called by save this will make sure that all the changes in category mappings are reflected in the database</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$ba = $ba-&gt;_insert_category($cat_id, $primary)</dt>
<dd>

<p>Adds a record that associates this ba with the category</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$ba = $ba-&gt;_delete_category( $cat_id)</dt>
<dd>

<p>Removes this record for the database</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$ba = $ba-&gt;_update_category($cat_id, $primary);</dt>
<dd>

<p>Preforms an update on the row in the data base</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_insert_story()</dt>
<dd>

<p>Inserts a story record into the database</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_insert_instance()</dt>
<dd>

<p>Inserts an instance record into the database</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_update_story()</dt>
<dd>

<p>Updates the story record in the database</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_update_instance()</dt>
<dd>

<p>Updates the record for the story instance</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_delete_instance();</dt>
<dd>

<p>Deletes the version record from a cancled checkout</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
<dt>$self = $self-&gt;_delete_story();</dt>
<dd>

<p>Deletes from the story table for a story that has never been checked in</p>

<p><b>Throws:</b></p>

<p>NONE</p>

<p><b>Side Effects:</b></p>

<p>NONE</p>

<p><b>Notes:</b></p>

<p>NONE</p>

</dd>
</dl>

<h1 id="Notes">Notes</h1>

<p>NONE</p>

<h1 id="Author">Author</h1>

<p>Michael Soderstrom &lt;miraso@pacbell.net&gt;</p>

<h1 id="See-Also">See Also</h1>

<p><a href="http://search.cpan.org/perldoc?perl">perl</a>, <a rel="section" href="../../../../../../2.0/api/Bric.html" name="Bric">Bric</a>, <a rel="section" href="../../../../../../2.0/api/Bric/Biz/Asset.html" name="Bric::Biz::Asset">Bric::Biz::Asset</a>, <a rel="section" href="../../../../../../2.0/api/Bric/Biz/Asset/Business.html" name="Bric::Biz::Asset::Business">Bric::Biz::Asset::Business</a></p>

</body>
</html>

